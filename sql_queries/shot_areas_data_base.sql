select 
action_type.PLAYER_ID
,action_type.GAME_ID
,[PlayerGameLogs].TEAM_ID
,[PlayerGameLogs].yearSeason
,[PlayerGameLogs].oppAbrv
,[PlayerGameLogs].GAME_DATE
,COALESCE(CASE WHEN ctr.[POSITION] = 'G-F' THEN 'G' ELSE
				 CASE WHEN ctr.[POSITION] = 'F-C' THEN 'F' ELSE
				 CASE WHEN ctr.[POSITION] = 'F-G' THEN 'F' ELSE
				 CASE WHEN ctr.[POSITION] = 'C-F' THEN 'C' ELSE
				 ctr.[POSITION] END END END END ,ctr2.POSITION,'NF') as POSITION
,COALESCE(AVG(CAST(Over_24_ft AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Over_24_ft AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Over_24_ft
,COALESCE(AVG(CAST(Back_Court_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Back_Court_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Back_Court_Shot
,COALESCE(AVG(CAST(Eight_to_Sixteen_ft AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Eight_to_Sixteen_ft AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Eight_to_Sixteen_ft
,COALESCE(AVG(CAST(Sixteen_to_TwentyFour_ft AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Sixteen_to_TwentyFour_ft AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Sixteen_to_TwentyFour_ft
,COALESCE(AVG(CAST(Less_Than_Eight_ft AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Less_Than_Eight_ft AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Less_Than_Eight_ft
,COALESCE(AVG(CAST(Right_Side_R AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Right_Side_R AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Right_Side_R
,COALESCE(AVG(CAST(Left_Side_L AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Left_Side_L AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Left_Side_L
,COALESCE(AVG(CAST(Left_Side_Center_LC AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Left_Side_Center_LC AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Left_Side_Center_LC
,COALESCE(AVG(CAST(Center_C AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Center_C AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Center_C
,COALESCE(AVG(CAST(Back_Court_BC AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Back_Court_BC AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Back_Court_BC
,COALESCE(AVG(CAST(Above_the_Break_3 AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Above_the_Break_3 AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Above_the_Break_3
,COALESCE(AVG(CAST(Restricted_Area AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Restricted_Area AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Restricted_Area
,COALESCE(AVG(CAST(Mid_Range AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Mid_Range AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Mid_Range
,COALESCE(AVG(CAST(Left_Corner_3 AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Left_Corner_3 AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Left_Corner_3
,COALESCE(AVG(CAST(Backcourt AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Backcourt AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Backcourt
,COALESCE(AVG(CAST(In_The_Paint_Non_RA AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(In_The_Paint_Non_RA AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_In_The_Paint_Non_RA
,COALESCE(AVG(CAST(Right_Corner_3 AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Right_Corner_3 AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Right_Corner_3
,COALESCE(AVG(CAST(Driving_Bank_shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Driving_Bank_shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Driving_Bank_shot
,COALESCE(AVG(CAST(Hook_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Hook_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Hook_Shot
,COALESCE(AVG(CAST(Driving_Jump_shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Driving_Jump_shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Driving_Jump_shot
,COALESCE(AVG(CAST(Running_Hook_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Running_Hook_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Running_Hook_Shot
,COALESCE(AVG(CAST(Tip_Layup_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Tip_Layup_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Tip_Layup_Shot
,COALESCE(AVG(CAST(Step_Back_Jump_shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Step_Back_Jump_shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Step_Back_Jump_shot
,COALESCE(AVG(CAST(Running_Finger_Roll_Layup_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Running_Finger_Roll_Layup_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Running_Finger_Roll_Layup_Shot
,COALESCE(AVG(CAST(Pullup_Bank_shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Pullup_Bank_shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Pullup_Bank_shot
,COALESCE(AVG(CAST(Driving_Reverse_Layup_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Driving_Reverse_Layup_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Driving_Reverse_Layup_Shot
,COALESCE(AVG(CAST(Running_Layup_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Running_Layup_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Running_Layup_Shot
,COALESCE(AVG(CAST(Alley_Oop_Layup_shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Alley_Oop_Layup_shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Alley_Oop_Layup_shot
,COALESCE(AVG(CAST(Driving_Hook_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Driving_Hook_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Driving_Hook_Shot
,COALESCE(AVG(CAST(Alley_Oop_Dunk_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Alley_Oop_Dunk_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Alley_Oop_Dunk_Shot
,COALESCE(AVG(CAST(Running_Alley_Oop_Dunk_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Running_Alley_Oop_Dunk_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Running_Alley_Oop_Dunk_Shot
,COALESCE(AVG(CAST(Turnaround_Jump_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Turnaround_Jump_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Turnaround_Jump_Shot
,COALESCE(AVG(CAST(Reverse_Dunk_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Reverse_Dunk_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Reverse_Dunk_Shot
,COALESCE(AVG(CAST(Running_Pull_Up_Jump_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Running_Pull_Up_Jump_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Running_Pull_Up_Jump_Shot
,COALESCE(AVG(CAST(Driving_Layup_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Driving_Layup_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Driving_Layup_Shot
,COALESCE(AVG(CAST(Turnaround_Fadeaway_shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Turnaround_Fadeaway_shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Turnaround_Fadeaway_shot
,COALESCE(AVG(CAST(Driving_Floating_Jump_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Driving_Floating_Jump_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Driving_Floating_Jump_Shot
,COALESCE(AVG(CAST(Driving_Dunk_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Driving_Dunk_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Driving_Dunk_Shot
,COALESCE(AVG(CAST(Cutting_Dunk_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Cutting_Dunk_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Cutting_Dunk_Shot
,COALESCE(AVG(CAST(Running_Dunk_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Running_Dunk_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Running_Dunk_Shot
,COALESCE(AVG(CAST(Running_Reverse_Dunk_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Running_Reverse_Dunk_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Running_Reverse_Dunk_Shot
,COALESCE(AVG(CAST(Running_Jump_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Running_Jump_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Running_Jump_Shot
,COALESCE(AVG(CAST(Driving_Reverse_Dunk_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Driving_Reverse_Dunk_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Driving_Reverse_Dunk_Shot
,COALESCE(AVG(CAST(Putback_Layup_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Putback_Layup_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Putback_Layup_Shot
,COALESCE(AVG(CAST(Fadeaway_Bank_shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Fadeaway_Bank_shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Fadeaway_Bank_shot
,COALESCE(AVG(CAST(Hook_Bank_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Hook_Bank_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Hook_Bank_Shot
,COALESCE(AVG(CAST(Tip_Dunk_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Tip_Dunk_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Tip_Dunk_Shot
,COALESCE(AVG(CAST(Step_Back_Bank_Jump_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Step_Back_Bank_Jump_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Step_Back_Bank_Jump_Shot
,COALESCE(AVG(CAST(No_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(No_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_No_Shot
,COALESCE(AVG(CAST(Pullup_Jump_shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Pullup_Jump_shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Pullup_Jump_shot
,COALESCE(AVG(CAST(Turnaround_Bank_shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Turnaround_Bank_shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Turnaround_Bank_shot
,COALESCE(AVG(CAST(Running_Reverse_Layup_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Running_Reverse_Layup_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Running_Reverse_Layup_Shot
,COALESCE(AVG(CAST(Turnaround_Fadeaway_Bank_Jump_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Turnaround_Fadeaway_Bank_Jump_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Turnaround_Fadeaway_Bank_Jump_Shot
,COALESCE(AVG(CAST(Running_Alley_Oop_Layup_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Running_Alley_Oop_Layup_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Running_Alley_Oop_Layup_Shot
,COALESCE(AVG(CAST(Finger_Roll_Layup_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Finger_Roll_Layup_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Finger_Roll_Layup_Shot
,COALESCE(AVG(CAST(Cutting_Layup_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Cutting_Layup_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Cutting_Layup_Shot
,COALESCE(AVG(CAST(Turnaround_Bank_Hook_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Turnaround_Bank_Hook_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Turnaround_Bank_Hook_Shot
,COALESCE(AVG(CAST(Floating_Jump_shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Floating_Jump_shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Floating_Jump_shot
,COALESCE(AVG(CAST(Layup_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Layup_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Layup_Shot
,COALESCE(AVG(CAST(Dunk_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Dunk_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Dunk_Shot
,COALESCE(AVG(CAST(Turnaround_Hook_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Turnaround_Hook_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Turnaround_Hook_Shot
,COALESCE(AVG(CAST(Reverse_Layup_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Reverse_Layup_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Reverse_Layup_Shot
,COALESCE(AVG(CAST(Cutting_Finger_Roll_Layup_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Cutting_Finger_Roll_Layup_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Cutting_Finger_Roll_Layup_Shot
,COALESCE(AVG(CAST(Driving_Floating_Bank_Jump_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Driving_Floating_Bank_Jump_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Driving_Floating_Bank_Jump_Shot
,COALESCE(AVG(CAST(Fadeaway_Jump_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Fadeaway_Jump_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Fadeaway_Jump_Shot
,COALESCE(AVG(CAST(Jump_Bank_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Jump_Bank_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Jump_Bank_Shot
,COALESCE(AVG(CAST(Driving_Finger_Roll_Layup_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Driving_Finger_Roll_Layup_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Driving_Finger_Roll_Layup_Shot
,COALESCE(AVG(CAST(Putback_Dunk_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Putback_Dunk_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Putback_Dunk_Shot
,COALESCE(AVG(CAST(Driving_Bank_Hook_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Driving_Bank_Hook_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Driving_Bank_Hook_Shot
,COALESCE(AVG(CAST(Jump_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID, [PlayerGameLogs].yearSeason ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),AVG(CAST(Jump_Shot AS FLOAT)) OVER ( PARTITION BY action_type.PLAYER_ID ORDER BY [PlayerGameLogs].GAME_DATE ROWS BETWEEN UNBOUNDED PRECEDING AND 1 PRECEDING ),0) AS Player_Jump_Shot


from [nba_game_data].[dbo].action_type

LEFT OUTER JOIN [nba_game_data].[dbo].shot_zone_area
ON 
action_type.PLAYER_ID = shot_zone_area.PLAYER_ID
and action_type.GAME_ID = shot_zone_area.GAME_ID

LEFT OUTER JOIN [nba_game_data].[dbo].shot_zone_basic
ON 
action_type.PLAYER_ID = shot_zone_basic.PLAYER_ID
and action_type.GAME_ID = shot_zone_basic.GAME_ID

LEFT OUTER JOIN [nba_game_data].[dbo].shot_zone_range
ON 
action_type.PLAYER_ID = shot_zone_range.PLAYER_ID
and action_type.GAME_ID = shot_zone_range.GAME_ID

LEFT OUTER JOIN [nba_game_data].[dbo].[PlayerGameLogs]
ON 
action_type.PLAYER_ID = [PlayerGameLogs].PLAYER_ID
and action_type.GAME_ID = [PlayerGameLogs].GAME_ID

LEFT OUTER JOIN [nba_game_data].[dbo].[CommonTeamRoster] ctr
ON
cast(action_type.PLAYER_ID as int) = cast(ctr.PLAYER_ID as int)
AND cast([PlayerGameLogs].TEAM_ID as int) = cast(ctr.TeamID as int)
AND cast([PlayerGameLogs].yearSeason as int) = cast(ctr.SEASON as int)

LEFT OUTER JOIN [nba_game_data].[dbo].[BackupPlayerPosition] ctr2
ON 
cast(action_type.PLAYER_ID as int) = cast(ctr2.PLAYER_ID as int)


order by PLAYER_ID, GAME_DATE